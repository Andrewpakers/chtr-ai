(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[180],{7722:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat",function(){return n(3430)}])},3430:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return v}});var s=n(5893),l=n(7294);function r(e){let{title:t,lastMessage:n}=e;return(0,s.jsxs)("div",{"data-testid":"chatroomTile",className:"pl-1 hover:border-2 hover:border-sky-400 w-full h-[60px] border-b-2 py-1 border-slate-200",children:[(0,s.jsx)("h3",{className:"font-bold",children:t}),(0,s.jsx)("span",{className:"text-sm",children:function(e,t){let n=String(e);return n?n.length<=t?n:n.slice(0,t)+"...":""}(n,30)})]})}var a=n(993),i=n(7495);function c(e){let{chatrooms:t,setActiveChat:n}=e,l=null==t?void 0:t.map(e=>(0,s.jsx)("li",{className:"",onClick:()=>n(null==e?void 0:e.name),children:(0,s.jsx)(r,{title:null==e?void 0:e.name,lastMessage:null==e?void 0:e.message})},null==e?void 0:e.id));return(0,s.jsx)("ul",{children:l})}function u(){let[e,t]=(0,l.useContext)(i.Fd),[n,r]=(0,l.useState)(e),[a,u]=(0,l.useContext)(i.cL);return(0,l.useEffect)(()=>{},[]),(0,l.useEffect)(()=>{t(n)},[n]),(0,s.jsx)("div",{className:"w-[300px] min-w-[300px] h-[650px] border-r-2 border-slate-200",children:(0,s.jsx)(c,{setActiveChat:r,chatrooms:a})})}n(9359);var o=n(9793);function d(e){let{inputRef:t,handleInput:n,messageInput:l}=e;return(0,s.jsxs)("div",{className:"flex w-full h-fit py-3",children:[(0,s.jsx)("div",{className:"w-full h-fit mr-3 mb-0",children:(0,s.jsx)("textarea",{className:" w-full h-[30px] resize-none border-none focus:outline-none border-transparent focus:border-transparent focus:ring-0",value:l,referance:t,placeholder:"Type here...",onChange:n})}),(0,s.jsx)("div",{className:"mt-auto mb-[6px] mr-2",children:(0,s.jsx)(o.zx,{className:"w-20 mt-auto",text:"Send",onClick:n,title:"Send"})})]})}function f(e){let{messages:t,activeChat:n}=e,l=[];for(let e=0;e<t.length;e++)if(t[e].chatroom===n){l=t[e].messages;break}if(l.length>0)return l.map(e=>(0,s.jsx)(o._p,{position:e.position,title:e.title,type:e.type,text:e.text,date:e.posted},e.id))}function h(){let[e,t]=(0,l.useContext)(i.Fd),[n,r]=(0,l.useContext)(i.V6);(0,l.useEffect)(()=>{a.current.scrollIntoView()},[e]);let a=(0,l.useRef)(null),c=(0,l.useRef)(null);return(0,l.useEffect)(()=>{(c.current.scrollHeight-c.current.scrollTop<=680||0===c.current.scrollTop||"right"===n.at(-1).position)&&a.current.scrollIntoView()},[n]),(0,s.jsxs)("div",{ref:c,className:"max-h-[595px] w-full bg-slate-300 p-0 overflow-y-scroll",children:[(0,s.jsx)(f,{messages:n,activeChat:e}),(0,s.jsx)("div",{ref:a})]})}var x=n(819);function p(e){let{inputRef:t,handleInput:n,messageInput:l,isLoggedIn:r}=e;return r?(0,s.jsx)(d,{inputRef:t,handleInput:n,messageInput:l}):(0,s.jsx)("div",{className:"p-4",children:(0,s.jsx)("span",{children:"Sign in to chat..."})})}function m(){let[e,t]=(0,l.useContext)(i.Fd),[n,r]=(0,l.useState)(""),c=(0,l.useRef)(null),[u,o]=(0,l.useState)(!1);function d(e){o(e)}return(0,l.useEffect)(()=>{o((0,x.hC)()),(0,x.YY)(d)},[]),(0,s.jsx)("div",{className:"w-full self-stretch",children:(0,s.jsxs)("div",{className:"w-full h-[650px]",children:[(0,s.jsx)(h,{}),(0,s.jsx)(p,{inputRef:c,handleInput:function(t){switch(t.type){case"change":let s=t.target.value.at(-1);if(t.target.value.length>1&&"\n"===s||"\r"===s){(0,a.oi)(e,n),r("");break}r(t.target.value);break;case"click":(0,a.oi)(e,n),r("");break;default:console.error("Input switch reached default: ".concat(t.type))}},messageInput:n,isLoggedIn:u})]})})}function v(){return(0,s.jsx)("main",{children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)(u,{}),(0,s.jsx)(m,{})]})})}}},function(e){e.O(0,[793,774,888,179],function(){return e(e.s=7722)}),_N_E=e.O()}]);